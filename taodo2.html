<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        async function getPublicIP() {
            const ipApis = [
                "https://api64.ipify.org?format=json",
                "https://ifconfig.me",
                "https://checkip.amazonaws.com"
            ];

            for (let api of ipApis) {
                try {
                    let response = await fetch(api);
                    let data = api.includes("json") ? await response.json() : await response.text();
                    return typeof data === "string" ? data.trim() : data.ip;
                } catch (error) {
                    console.log(`L·ªói khi l·∫•y IP t·ª´ ${api}`);
                }
            }
            return null;
        }

        async function getLocationFromIP(ip) {
            const locationApis = [
                `http://ip-api.com/json/${ip}`,
                `https://geolocation-db.com/json/${ip}`,
                `https://ipinfo.io/${ip}/json`
            ];

            for (let api of locationApis) {
                try {
                    let response = await fetch(api);
                    let data = await response.json();

                    if (data.status === "fail" || data.error) continue; // N·∫øu API b·ªã l·ªói, th·ª≠ API kh√°c

                    let latitude = data.lat || data.latitude || (data.loc ? data.loc.split(",")[0] : null);
                    let longitude = data.lon || data.longitude || (data.loc ? data.loc.split(",")[1] : null);

                    return {
                        city: data.city || "Kh√¥ng x√°c ƒë·ªãnh",
                        region: data.region || data.state || "Kh√¥ng x√°c ƒë·ªãnh",
                        country: data.country || data.country_name || "Kh√¥ng x√°c ƒë·ªãnh",
                        lat: latitude,
                        lon: longitude
                    };
                } catch (error) {
                    console.log(`L·ªói khi l·∫•y v·ªã tr√≠ t·ª´ ${api}`);
                }
            }
            return null;
        }

        async function getUserLocation() {
            let ip = await getPublicIP();
            if (!ip) {
                console.log("Kh√¥ng th·ªÉ l·∫•y ƒë·ªãa ch·ªâ IP.");
                return;
            }
            console.log("IP c√¥ng c·ªông c·ªßa b·∫°n:", ip);

            let location = await getLocationFromIP(ip);
            if (!location) {
                console.log("Kh√¥ng th·ªÉ l·∫•y v·ªã tr√≠ t·ª´ IP.");
                return;
            }

            console.log(`üìç V·ªã tr√≠ c·ªßa b·∫°n: ${location.city}, ${location.region}, ${location.country}`);
            console.log(`üåç T·ªça ƒë·ªô g·∫ßn ƒë√∫ng: Latitude: ${location.lat}, Longitude: ${location.lon}`);
        }

        // G·ªçi h√†m ƒë·ªÉ l·∫•y t·ªça ƒë·ªô t·ª´ IP
        getUserLocation();


    </script>
</body>

</html>